<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Oak Tecnologia</title>
    <link rel="stylesheet" href="style2.css" />
    <script
      src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"
      type="text/javascript"
    ></script>
    <script src="script.js" defer></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Tilt+Neon&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <header>
        <h1 id="cabeca">Oak Tecnologia</h1>
      </header>
    <h1 id="textLista">Lista de produtos</h1>
    <button id="open-modal">ADICIONAR PRODUTO</button>
    <div id="fade" class="hide"></div>
    <div id="modal" class="hide">
      <div class="modal-header">
        <h2>Cadastro de Produtos</h2>
        <button id="close-modal">Fechar</button>
      </div>
      <div class="modal-body">
        <main>
            <div class="card">
              <div class="lineInput">
                <label for="produto"> Nome: </label>
                <input
                  type="text"
                  name="produto"
                  id="produto"
                  placeholder="Nome do Produto"
                />
              </div>
              <div class="lineInput">
                <label for="descricao">Descrição: </label>
                <!-- <input
                  type="text"
                  name="descricao"
                  id="descricao"
                  placeholder="Descrição do Produto"
                /> -->
                <textarea id="descricao" name="message" rows="5" cols="80" placeholder="Descrição do Produto:"></textarea
                         >
              </div>
              <div class="lineInput">
                <form method="post" action="#">
                  <label for="currency-field">Valor: </label>
                  <input
                    type="text"
                    name="currency-field"
                    id="currency-field"
                    pattern="^\$\d{1,3}(,\d{3})*(\.\d+)?$"
                    value=""
                    data-type="currency"
                    placeholder="$1,000,000.00"
                  />
                </form>
              </div>
              <div class="lineInput2">
                 <!-- <input
                  type="radio"
                  class="disponibilidadeVenda"
                  name="disponibilidadeVenda"
                  value="sim"
                />
                <label for="sim">Sim</label>
                <input
                  type="radio"
                  class="disponibilidadeVenda"
                  name="disponibilidadeVenda"
                  value="nao"
                />
                <label for="nao">Não</label><br /> 
                 -->
                  
                <label for="venda">Disponivel para venda:</label>
                <select id="disponibilidadeVenda" name="disponibilidadeVenda"
                        size="1">
                  <option value="Sim">Sim</option>
                  <option value="Não">Não</option>
                </select>
              </div>
              <button type="button" id="saveButton" onclick="produto.salvar()">Salvar</button>
              <button type="button" onclick="produto.cancelar()">Redefinir</button>
            </div>
      </div>
    </div>
    <div class="content">
        <table id="myTable" class="table">
          <thead>
            <th>ID</th>
            <th>Nome</th>
            <th>Descrição</th>
            <th class="valor">Valor</th>
            <th>Disponível:</th>  
            <th>Editar</th>
          </thead>
          <tbody id="tbody">
          </tbody>
        </table>
      </div>
  </body>
  <script>
    $("input[data-type='currency']").on({
      keyup: function () {
      
        formatCurrency($(this));
      },
      blur: function () {
        
        formatCurrency($(this), "blur");
      },
    });

    function formatNumber(n) {
      // format number 1000000 to 1,234,567
      return n.replace(/\D/g, "").replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    }

    function formatCurrency(input, blur) {
      // appends $ to value, validates decimal side
      // and puts cursor back in right position.

      // get input value
      var input_val = input.val();

      // don't validate empty input
      if (input_val === "") {
        return;
      }

      // original length
      var original_len = input_val.length;

      // initial caret position
      var caret_pos = input.prop("selectionStart");

      // check for decimal
      if (input_val.indexOf(".") >= 0) {
        // get position of first decimal
        // this prevents multiple decimals from
        // being entered
        var decimal_pos = input_val.indexOf(".");

        // split number by decimal point
        var left_side = input_val.substring(0, decimal_pos);
        var right_side = input_val.substring(decimal_pos);

        // add commas to left side of number
        left_side = formatNumber(left_side);

        // validate right side
        right_side = formatNumber(right_side);

        // On blur make sure 2 numbers after decimal
        if (blur === "blur") {
          right_side += "00";
        }

        // Limit decimal to only 2 digits
        right_side = right_side.substring(0, 2);

        // join number by .
        input_val = "$" + left_side + "." + right_side;
      } else {
        // no decimal entered
        // add commas to number
        // remove all non-digits
        input_val = formatNumber(input_val);
        input_val = "$" + input_val;

        // final formatting
        if (blur === "blur") {
          input_val += ".00";
        }
      }

      // send updated string to input
      input.val(input_val);

      // put caret back in the right position
      var updated_len = input_val.length;
      caret_pos = updated_len - original_len + caret_pos;
      input[0].setSelectionRange(caret_pos, caret_pos);
    }
  </script>
</html>